<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Documentation for Android Tamer">
        <meta name="author" content="AndroidTamer Team">
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <meta name="twitter:card" content="summary" />
        
        <meta name="twitter:site" content="https://www.twitter.com/androidtamer" />
        
        <meta name="twitter:title" content="AndroidTamer" />
        <meta property="og:title" content="AndroidTamer" />
        <meta property="og:url" content="" />
        
        <meta property="og:description" content="Documentation for Android Tamer" />
        <meta name="twitter:description" content="Documentation for Android Tamer" />
        
        
        <title>04 Insecure Data Storage P2 - AndroidTamer</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        
        
        <link rel="stylesheet" href="../../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">AndroidTamer</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Application</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Development/Application/basics/">Basic Development Tools</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">ROM Development</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Development/ROM Development/fastboot/">Fastboot</a>
</li>

        
            
<li >
    <a href="../../../Development/ROM Development/heimdall/">Heimdall</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Examples/adb/">Adb</a>
</li>

                        
                            
<li >
    <a href="../../../Examples/fastboot/">Fastboot</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">General <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../General/decompile/">Decompiling Application</a>
</li>

                        
                            
<li >
    <a href="../../../General/multi_devices/">Managing multiple devices</a>
</li>

                        
                            
<li >
    <a href="../../../General/packages/">Packages</a>
</li>

                        
                            
<li >
    <a href="../../../General/python_packages/">Python packages</a>
</li>

                        
                            
<li >
    <a href="../../../General/repo_configure/">AndroidTamer Repository in Debian 8</a>
</li>

                        
                            
<li >
    <a href="../../../General/running_emulator/">Emulator</a>
</li>

                        
                            
<li >
    <a href="../../../General/screenshot/">How to take screenshots of device</a>
</li>

                        
                            
<li >
    <a href="../../../General/tools_mindmap/">MindMap: Tools Present in AndroidTamer</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Security Assessment <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Automated Analysis</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Security Assessment/Automated Analysis/MobSF/">MobSF: Mobile Security Framework</a>
</li>

        
            
<li >
    <a href="../../../Security Assessment/Automated Analysis/drozer/">Drozer</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Manual Analysis</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Security Assessment/Manual Analysis/APKTool/">APKTool</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Pentesting</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Security Assessment/Pentesting/Burpsuite/">Burpsuite</a>
</li>

        
            
<li >
    <a href="../../../Security Assessment/Pentesting/nikto/">Nikto</a>
</li>

        
            
<li >
    <a href="../../../Security Assessment/Pentesting/nmap/">Nmap</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Training <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../">Home</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">DIVA</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../00_Home/">00 Home</a>
</li>

        
            
<li >
    <a href="../01_Insecure_Logging/">01 Insecure Logging</a>
</li>

        
            
<li >
    <a href="../02_Hardcoding_Issues/">02 Hardcoding Issues</a>
</li>

        
            
<li >
    <a href="../03_Insecure_Data_Storage_P1/">03 Insecure Data Storage P1</a>
</li>

        
            
<li class="active">
    <a href="./">04 Insecure Data Storage P2</a>
</li>

        
            
<li >
    <a href="../05_Insecure_Data_Storage_P3/">05 Insecure Data Storage P3</a>
</li>

        
            
<li >
    <a href="../06_Insecure_Data_Storage_P4/">06 Insecure Data Storage P4</a>
</li>

        
            
<li >
    <a href="../07_Input_Validation_Issues_P1/">07 Input Validation Issues P1</a>
</li>

        
            
<li >
    <a href="../08_Input_Validation_Issues_P2/">08 Input Validation Issues P2</a>
</li>

        
            
<li >
    <a href="../09_Access_Control_Issues_P1/">09 Access Control Issues P1</a>
</li>

        
            
<li >
    <a href="../10_Access_Control_Issues_P2/">10 Access Control Issues P2</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                
                
                
                    <li>
                        <a href="https://www.twitter.com/androidtamer"><i class="fa fa-twitter fa-lg"></i></a>
                    </li>
                
                
                    <li>
                        <a href="https://www.facebook.com/AndroidTamer"><i class="fa fa-facebook fa-lg"></i></a>
                    </li>
                
                
                
                    <li>
                        <a href="https://webchat.freenode.net/?url=irc://irc.freenode.net/androidtamer"><i class="fa fa-hashtag fa-lg"></i></a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/AndroidTamer/Tools/">
                            
                                <i class="fa fa-github fa-lg"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                
                    <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#insecure-data-storage-part-2">Insecure Data Storage - Part 2</a></li>
        
            <li><a href="#takeaway">Takeaway</a></li>
        
    
    </ul>
</div></div>
                    <div class="col-md-9" role="main">

<div class="content">


<h2 id="insecure-data-storage-part-2">Insecure Data Storage - Part 2</h2>
<p>When you click on <strong>Insecure Data Storage - Part 2</strong>, you would see the following screen.</p>
<p><center><img alt="Insecure Data Storage 2a" src="../../../images/vuln_apps/DIVA/Challenge_4a.png" /></center></p>
<p>It's view is similar to the previous challenge. Let's enter some credentials.</p>
<p><center><img alt="Insecure Data Storage 2b" src="../../../images/vuln_apps/DIVA/Challenge_4b.png" /></center></p>
<p>We get a message stating that <em>3rd party credentials saved successfully</em>.</p>
<p>Let's check the pseudocode of this activity with the help of <a href="../02_Hardcoding_Issues/" target="_blank">dex2jar and jd-gui</a>.</p>
<p><center><img alt="Insecure Data Storage 2c" src="../../../images/vuln_apps/DIVA/Challenge_4c.png" /></center></p>
<p><center><img alt="Insecure Data Storage 2d" src="../../../images/vuln_apps/DIVA/Challenge_4d.png" /></center></p>
<p>From the code we can understand that the activity creates a database <strong><code>ids2</code></strong> if it doesn't exist. Then creates a table <strong><code>myuser</code></strong> which holds the strings <code>user</code> and <code>password</code>. In the function <code>saveCredentials()</code>, the app inserts the credentials into the table.</p>
<p>In Android, <code>sqlite3</code> database format is used to store data as they are lightweight and runs on low memory devices. The databases of any app are stored in the location <code>/data/data/&lt;package_name&gt;/databases</code> where <code>&lt;package_name&gt;</code> is the unique name for each Android app.</p>
<p>Connect the emulator or the physical device in which the DIVA app is running. Make sure that you are <strong>root</strong> user. Go to the directory at <code>/data/data/jakhar.aseem.diva/databases</code> and check if there is any database with the name <code>ids2</code>.</p>
<p><center><img alt="Insecure Data Storage 2e" src="../../../images/vuln_apps/DIVA/Challenge_4e.png" /></center></p>
<p>Then execute the command <code>sqlite3 ids2</code> to open the database.</p>
<p><center><img alt="Insecure Data Storage 2f" src="../../../images/vuln_apps/DIVA/Challenge_4f.png" /></center></p>
<blockquote>
<p><strong>NOTE:</strong> <code>sqlite3</code> binary is pre-installed in most of the Android emulators and devices. If your physical device doesn't contain this binary, then try to pull the database to the local system with the help of adb (<code>adb pull /data/data/jakhar.aseem.databases/ids2</code>). Then use a local sqlite database management tool like <code>sqlitebrowser</code> to view the contents.</p>
</blockquote>
<p>Type <code>.tables</code> and hit enter to view the tables created.</p>
<p><center><img alt="Insecure Data Storage 2g" src="../../../images/vuln_apps/DIVA/Challenge_4g.png" /></center></p>
<p>Run the query <code>.schema myuser</code> to view the schema of the table.</p>
<p><center><img alt="Insecure Data Storage 2h" src="../../../images/vuln_apps/DIVA/Challenge_4h.png" /></center></p>
<p>Run the query <code>select user, password from myuser</code> to get all the stored credentials.</p>
<p><center><img alt="Insecure Data Storage 2i" src="../../../images/vuln_apps/DIVA/Challenge_4i.png" /></center></p>
<blockquote>
<p><strong>NOTE:</strong> Running the query <code>.dump</code> will dump all the previously executed queries of a database.</p>
<p><center><img alt="Insecure Data Storage 2y" src="../../../images/vuln_apps/DIVA/Challenge_4y.png" /></center></p>
</blockquote>
<p><strong>Alternate way:</strong></p>
<p>If we had seen the most recently modified file with the help of <code>ls -la</code>, we shall have understood that a file under <code>databases</code> folder had been modified. This method didn't require the decompilation of the app to view source code.</p>
<p><center><img alt="Insecure Data Storage 2z" src="../../../images/vuln_apps/DIVA/Challenge_4z.png" /></center></p>
<h3 id="takeaway">Takeaway</h3>
<ul>
<li>Android uses <code>sqlite3</code> databases to store the data</li>
<li>The databases of apps are stored under <code>/data/data/&lt;package_name&gt;/databases</code> directory</li>
<li>Using <code>sqlite3</code> in Android we could view (and manage) the data inside the database</li>
<li><code>.tables</code> - to view tables</li>
<li><code>.schema &lt;tablename&gt;</code> - to view the schema of the table</li>
<li><code>.dump</code> - to dump all the executed queries in the database</li>
</ul>

</div></div>
                
            
        </div>

        <footer class="col-md-12">
            <hr>
            
                <p><b>&copy; AndroidTamer Team</b></p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> - Last updated : 2017-12-26</p>
        </footer>

        <script src="../../../js/jquery-1.12.3.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        
        <script>var base_url = '../../..';</script>

        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>

        <script src="../../../js/base.js"></script>
        <script src="../../../search/require.js"></script>
        <script src="../../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>